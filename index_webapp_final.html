<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì—Ä–∞ "–°–∫—Ä–∏–Ω—å–∫–∏" - –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f5f5f5; }
        .game-container { background-color: white; border-radius: 10px; padding: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .card { display: inline-block; padding: 5px 10px; margin: 5px; border: 1px solid #ddd; border-radius: 5px; background-color: white; cursor: pointer; }
        .card.selected { background-color: #d4edda; border-color: #c3e6cb; }
        .hearts, .diamonds { color: red; }
        .clubs, .spades { color: black; }
        .controls { margin: 20px 0; padding: 15px; background-color: #f8f9fa; border-radius: 5px; }
        button { padding: 8px 15px; margin: 5px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:disabled { background-color: #6c757d; cursor: not-allowed; }
        .suit-btn { font-size: 20px; width: 40px; height: 40px; }
        .game-info, .players-list { margin-bottom: 20px; }
        .player-info { border-bottom: 1px solid #eee; padding: 5px 0; }
        .box { display: inline-block; padding: 5px 10px; margin: 5px; border: 1px solid #17a2b8; border-radius: 5px; background-color: #d1ecf1; }
        .game-log { margin-top: 20px; padding: 10px; background-color: #f8f9fa; border-radius: 5px; max-height: 200px; overflow-y: auto; }
        .log-entry { margin: 5px 0; padding: 5px; border-bottom: 1px solid #eee; }
        .system-log { font-weight: bold; color: #28a745; }
        .turn-log { color: #007bff; }
        .error-log { color: #dc3545; }
        .lobby { text-align: center; }
        .game-over-modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 500px; border-radius: 10px; text-align: center; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: black; }
        #my-hand h3 { margin-bottom: 0; }
        #opponent-selection { margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>–ì—Ä–∞ "–°–∫—Ä–∏–Ω—å–∫–∏"</h1>

        <div id="lobby-view" class="lobby">
            <h2>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ!</h2>
            <p>–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ —ñ–º'—è —Ç–∞ –ø—Ä–∏—î–¥–Ω–∞–π—Ç–µ—Å—å –¥–æ –≥—Ä–∏.</p>
            <input type="text" id="player-name-input" placeholder="–í–∞—à–µ —ñ–º'—è" required><br><br>
            <input type="text" id="room-id-input" placeholder="ID –∫—ñ–º–Ω–∞—Ç–∏ (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)">
            <button id="join-btn">–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è</button>
            <br>
            <p id="room-info" style="margin-top: 10px;"></p>
        </div>

        <div id="game-view" style="display: none;">
            <div id="players-list" class="game-info">
                <h3>–ì—Ä–∞–≤—Ü—ñ –≤ –∫—ñ–º–Ω–∞—Ç—ñ (<span id="player-count">0</span>)</h3>
                <ul id="players-ul"></ul>
            </div>
            <button id="start-game-btn" style="display: none;">–ü–æ—á–∞—Ç–∏ –≥—Ä—É</button>

            <div id="game-started-view" style="display: none;">
                <div class="game-info">
                    <h3>–ü–æ—Ç–æ—á–Ω–∏–π –≥—Ä–∞–≤–µ—Ü—å: <span id="current-player"></span></h3>
                    <p>–ö–∞—Ä—Ç —É –∫–æ–ª–æ–¥—ñ: <span id="deck-count"></span></p>
                </div>

                <div id="my-hand">
                    <h3>–í–∞—à—ñ –∫–∞—Ä—Ç–∏:</h3>
                    <div id="my-cards"></div>
                </div>

                <div class="controls" id="player-controls">
                    <div id="opponent-selection">
                        <p>–û–±–µ—Ä—ñ—Ç—å –æ–ø–æ–Ω–µ–Ω—Ç–∞:</p>
                        <select id="opponent-select"></select>
                    </div>
                    <div id="rank-selection">
                        <p>–û–±–µ—Ä—ñ—Ç—å –Ω–æ–º—ñ–Ω–∞–ª:</p>
                        <div id="rank-buttons"></div>
                    </div>
                    <div id="count-selection" style="display: none;">
                        <p>–û–±–µ—Ä—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å:</p>
                        <button class="count-btn" data-count="1">1</button>
                        <button class="count-btn" data-count="2">2</button>
                        <button class="count-btn" data-count="3">3</button>
                        <button class="count-btn" data-count="4">4</button>
                    </div>
                    <div id="suit-selection" style="display: none;">
                        <p>–û–±–µ—Ä—ñ—Ç—å –º–∞—Å—Ç—ñ:</p>
                        <button class="suit-btn hearts" data-suit="‚ô•">‚ô•</button>
                        <button class="suit-btn diamonds" data-suit="‚ô¶">‚ô¶</button>
                        <button class="suit-btn clubs" data-suit="‚ô£">‚ô£</button>
                        <button class="suit-btn spades" data-suit="‚ô†">‚ô†</button>
                        <div id="selected-suits-display"></div>
                        <button id="submit-request" disabled>–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∑–∞–ø–∏—Ç</button>
                    </div>
                </div>
            </div>
            
            <div class="game-log">
                <h3>–Ü—Å—Ç–æ—Ä—ñ—è –≥—Ä–∏:</h3>
                <div id="game-history"></div>
            </div>
        </div>
    </div>
    
    <div id="game-over-modal" class="game-over-modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–ì—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
            <div id="game-result"></div>
            <button id="play-again-btn">–ì—Ä–∞—Ç–∏ –∑–Ω–æ–≤—É</button>
        </div>
    </div>

   <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        const tg = window.Telegram.WebApp;
        const WS_URL = "wss://telegram-webapp-beispiel.onrender.com"; 
        let playerName = '';
        let roomID = null;
        let gameState = null;
        let playerHand = [];
        let currentPlayer = '';
        let currentStep = 'ask_rank';
        let turnState = {};

        const elements = {
            lobbyView: document.getElementById('lobby-view'),
            gameView: document.getElementById('game-view'),
            playerNameInput: document.getElementById('player-name-input'),
            roomIdInput: document.getElementById('room-id-input'),
            joinBtn: document.getElementById('join-btn'),
            roomInfo: document.getElementById('room-info'),
            playersUl: document.getElementById('players-ul'),
            playerCount: document.getElementById('player-count'),
            startGameBtn: document.getElementById('start-game-btn'),
            gameStartedView: document.getElementById('game-started-view'),
            currentPlayerDisplay: document.getElementById('current-player'),
            deckCount: document.getElementById('deck-count'),
            myCards: document.getElementById('my-cards'),
            playerControls: document.getElementById('player-controls'),
            opponentSelect: document.getElementById('opponent-select'),
            rankSelection: document.getElementById('rank-selection'),
            rankButtons: document.getElementById('rank-buttons'),
            countSelection: document.getElementById('count-selection'),
            suitSelection: document.getElementById('suit-selection'),
            selectedSuitsDisplay: document.getElementById('selected-suits-display'),
            submitRequestBtn: document.getElementById('submit-request'),
            gameHistory: document.getElementById('game-history'),
            gameOverModal: document.getElementById('game-over-modal'),
            gameResult: document.getElementById('game-result'),
            playAgainBtn: document.getElementById('play-again-btn'),
            closeModal: document.querySelector('.close')
        };
		
		if (tg) {
            tg.ready();
            tg.expand();
            if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                const u = tg.initDataUnsafe.user;
                telegramUser = u.username ? `@${u.username}` : (u.first_name || '–ì—Ä–∞–≤–µ—Ü—å');
                elements.playerNameInput.value = telegramUser;
            } else {
                telegramUser = "–ê–Ω–æ–Ω—ñ–º–Ω–∏–π –≥—Ä–∞–≤–µ—Ü—å";
            }
        } else {
            telegramUser = "–¢–µ—Å—Ç–æ–≤–∏–π –≥—Ä–∞–≤–µ—Ü—å";
        }

        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            console.log("Received:", data);

            switch (data.type) {
                case 'room_created':
                    roomID = data.room_id;
                    elements.roomInfo.textContent = `–ö—ñ–º–Ω–∞—Ç—É —Å—Ç–≤–æ—Ä–µ–Ω–æ. ID: ${roomID}. –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –≥—Ä–∞–≤—Ü—ñ–≤...`;
                    break;
                case 'room_state':
                    updateLobbyView(data);
                    break;
                case 'game_started':
                case 'state_update': // –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ —Ö–æ–¥—É –≥—Ä–∞–≤—Ü—è —Å–µ—Ä–≤–µ—Ä –ø–æ–≤–µ—Ä—Ç–∞—î state_update
                    gameState = data.state;
                    playerHand = data.hand;
                    currentPlayer = data.state.currentPlayer;
                    
                    if (playerName === currentPlayer) {
                        currentStep = 'ask_rank'; // –°–∫–∏–¥–∞—î–º–æ –∫—Ä–æ–∫ –Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π, —â–æ–± –≥—Ä–∞–≤–µ—Ü—å –º—ñ–≥ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —Ö—ñ–¥
                        turnState = {}; // –û—á–∏—â–∞—î–º–æ —Å—Ç–∞–Ω —Ö–æ–¥—É
                    }

                    updateUI();
                    break;
                case 'next_step':
                    currentStep = data.step;
                    turnState = { opponent: data.opponent, rank: data.rank, count: data.count };
                    playerHand = data.hand;
                    updateUI();
                    break;
                case 'game_over':
                    gameState = data.state;
                    showGameOverModal(data.state, data.winners);
                    break;
                case 'info':
                    addLogEntry(data.message, 'system');
                    break;
                case 'error':
                    addLogEntry(`–ü–æ–º–∏–ª–∫–∞: ${data.message}`, 'error');
                    break;
            }
        };

        ws.onopen = function() {
            console.log("Connected to WebSocket server.");
        };

        ws.onclose = function() {
            addLogEntry("–ó'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º –≤—Ç—Ä–∞—á–µ–Ω–æ.", 'error');
        };

        elements.joinBtn.addEventListener('click', () => {
            playerName = elements.playerNameInput.value.trim();
            roomID = elements.roomIdInput.value.trim();

            if (playerName) {
                const joinMessage = {
                    action: "join",
                    name: playerName,
                    room_id: roomID || null
                };
                ws.send(JSON.stringify(joinMessage));
                elements.lobbyView.style.display = 'none';
                elements.gameView.style.display = 'block';
            }
        });

        elements.startGameBtn.addEventListener('click', () => {
            const startMessage = { action: "start_game" };
            ws.send(JSON.stringify(startMessage));
        });

        elements.rankButtons.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON' && e.target.dataset.rank) {
                const rank = e.target.dataset.rank;
                const opponent = elements.opponentSelect.value;
                if (!opponent) {
                    addLogEntry("–û–±–µ—Ä—ñ—Ç—å –æ–ø–æ–Ω–µ–Ω—Ç–∞!", 'error');
                    return;
                }
                const turnMessage = { action: "make_turn", step: "ask_rank", opponent, rank };
                ws.send(JSON.stringify(turnMessage));
            }
        });

        document.querySelectorAll('.count-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const guess = parseInt(btn.dataset.count);
                const turnMessage = { action: "make_turn", step: "guess_count", opponent: turnState.opponent, rank: turnState.rank, guess };
                ws.send(JSON.stringify(turnMessage));
            });
        });

        const selectedSuits = new Set();
        document.querySelectorAll('.suit-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const suit = btn.dataset.suit;
                if (selectedSuits.has(suit)) {
                    selectedSuits.delete(suit);
                    btn.classList.remove('selected');
                } else if (selectedSuits.size < turnState.count) {
                    selectedSuits.add(suit);
                    btn.classList.add('selected');
                }
                updateSelectedSuitsDisplay();
                updateSubmitButtonState();
            });
        });

        elements.submitRequestBtn.addEventListener('click', () => {
            if (selectedSuits.size === turnState.count) {
                const turnMessage = { action: "make_turn", step: "guess_suits", opponent: turnState.opponent, rank: turnState.rank, suits: Array.from(selectedSuits) };
                ws.send(JSON.stringify(turnMessage));
                selectedSuits.clear();
                document.querySelectorAll('.suit-btn').forEach(btn => btn.classList.remove('selected'));
                updateSubmitButtonState();
            }
        });

        elements.playAgainBtn.addEventListener('click', () => {
            window.location.reload();
        });

        elements.closeModal.addEventListener('click', () => {
            elements.gameOverModal.style.display = 'none';
        });

        function updateLobbyView(data) {
            elements.playersUl.innerHTML = '';
            elements.playerCount.textContent = data.players.length;
            data.players.forEach(p => {
                const li = document.createElement('li');
                li.textContent = p;
                elements.playersUl.appendChild(li);
            });

            if (data.players.length >= 2) {
                elements.startGameBtn.style.display = 'block';
            } else {
                elements.startGameBtn.style.display = 'none';
            }
        }

        function updateUI() {
            if (!gameState) return;

            elements.gameStartedView.style.display = 'block';
            elements.currentPlayerDisplay.textContent = gameState.currentPlayer;
            elements.deckCount.textContent = gameState.deckCount;

            updatePlayerHands();
            updatePlayerInfo();
            updateHistory();
            updateControls();
        }

        function updatePlayerHands() {
            elements.myCards.innerHTML = '';
            const myHand = playerHand || [];
            myHand.sort().forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                cardElement.textContent = card;
                const suit = card.slice(-1);
                cardElement.classList.add(suit === '‚ô•' || suit === '‚ô¶' ? 'hearts' : 'clubs');
                elements.myCards.appendChild(cardElement);
            });
        }

        function updatePlayerInfo() {
            elements.playersUl.innerHTML = '';
            elements.opponentSelect.innerHTML = '';

            gameState.players.forEach(p => {
                const li = document.createElement('li');
                li.className = 'player-info';
                let boxes = gameState.collectedBoxes[p].length;
                let handSize = gameState.hands[p].length;
                let infoText = `${p}: –°–∫—Ä–∏–Ω—å–æ–∫: ${boxes} (${gameState.collectedBoxes[p].join(', ')}), –ö–∞—Ä—Ç: ${handSize}`;
                
                if (p === playerName) {
                    infoText += " (–í–∏)";
                }

                li.textContent = infoText;
                elements.playersUl.appendChild(li);

                if (p !== playerName) {
                    const option = document.createElement('option');
                    option.value = p;
                    option.textContent = p;
                    elements.opponentSelect.appendChild(option);
                }
            });
        }

        function updateHistory() {
            elements.gameHistory.innerHTML = '';
            gameState.history.forEach(entry => {
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${entry.type}-log`;
                logEntry.textContent = entry.message;
                elements.gameHistory.appendChild(logEntry);
            });
            elements.gameHistory.scrollTop = elements.gameHistory.scrollHeight;
        }

        function updateControls() {
            const isMyTurn = (playerName === gameState.currentPlayer);
            elements.playerControls.style.display = isMyTurn ? 'block' : 'none';

            if (isMyTurn) {
                if (currentStep === 'ask_rank') {
                    elements.rankSelection.style.display = 'block';
                    elements.countSelection.style.display = 'none';
                    elements.suitSelection.style.display = 'none';
                    setupRankButtons();
                } else if (currentStep === 'guess_count') {
                    elements.rankSelection.style.display = 'none';
                    elements.countSelection.style.display = 'block';
                    elements.suitSelection.style.display = 'none';
                } else if (currentStep === 'guess_suits') {
                    elements.rankSelection.style.display = 'none';
                    elements.countSelection.style.display = 'none';
                    elements.suitSelection.style.display = 'block';
                    updateSubmitButtonState();
                }
            } else {
                currentStep = 'ask_rank';
            }
        }

        function setupRankButtons() {
            if (!gameState) return;
            elements.rankButtons.innerHTML = '';
            
            const allRanks = ['6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            const availableRanks = allRanks.filter(rank => {
                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –Ω–æ–º—ñ–Ω–∞–ª –≤–∂–µ –∑—ñ–±—Ä–∞–Ω–∏–π –±—É–¥—å-—è–∫–∏–º –≥—Ä–∞–≤—Ü–µ–º
                return !Object.values(gameState.collectedBoxes).some(boxes => boxes.includes(rank));
            });

            availableRanks.forEach(rank => {
                const btn = document.createElement('button');
                btn.textContent = rank;
                btn.dataset.rank = rank;
                elements.rankButtons.appendChild(btn);
            });
        }

        function updateSelectedSuitsDisplay() {
            const suits = Array.from(selectedSuits);
            elements.selectedSuitsDisplay.innerHTML = '–í–∏–±—Ä–∞–Ω–æ –º–∞—Å—Ç–µ–π: ' + suits.map(suit => {
                const colorClass = (suit === '‚ô•' || suit === '‚ô¶') ? 'hearts' : 'clubs';
                return `<span class="${colorClass}">${suit}</span>`;
            }).join(', ');
        }

        function updateSubmitButtonState() {
            elements.submitRequestBtn.disabled = selectedSuits.size !== turnState.count;
        }

        // cd /d "D:\Skrunka_Bot_TELEGRAM"
		  
		function showGameOverModal(state, winners) { 
            const modal = document.getElementById("game-over-modal");
            const gameResultDiv = document.getElementById("game-result");

            let resultHTML = "<h3>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</h3>";

            // –ü—ñ–¥—Å—É–º–∫–∏ –ø–æ –∫–æ–∂–Ω–æ–º—É –≥—Ä–∞–≤—Ü—é
            for (const player of state.players) {
            const boxes = state.boxes[player];
            const collected = state.collectedBoxes[player].join(', ');
                resultHTML += `<p>${player}: ${boxes} —Å–∫—Ä–∏–Ω—å–æ–∫ (${collected})</p>`;
            }

            const totalPlayers = state.players.length;

            // –î–æ–¥–∞—î–º–æ –µ–º–æ–¥–∑—ñ üèÜ –±—ñ–ª—è –ø–µ—Ä–µ–º–æ–∂—Ü—ñ–≤
            const winnersWithTrophy = winners.map(name => `üèÜ ${name}`);

            // –ú–∞—Å–∏–≤–∏ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
            const singleWinnerMsgs = [
                `–ü–µ—Ä–µ–º–æ–∂–µ—Ü—å: ${winnersWithTrophy[0]}!`,
                `–ß–µ–º–ø—ñ–æ–Ω —Ü—å–æ–≥–æ —Ä–∞—É–Ω–¥—É ‚Äî ${winnersWithTrophy[0]}!`,
                `–ë–µ–∑–∑–∞–ø–µ—Ä–µ—á–Ω–∏–π –ª—ñ–¥–µ—Ä: ${winnersWithTrophy[0]}!`
            ];

            const fullTieMsgs = [
                `–ù—ñ—á–∏—è! –í—Å—ñ –≥—Ä–∞–ª–∏ –¥–æ–±—Ä–µ —ñ —Ä—ñ–≤–Ω—ñ –º—ñ–∂ —Å–æ–±–æ—é: ${winnersWithTrophy.join(', ')}!`,
                `–ü–æ–≤–Ω–∞ —Ä—ñ–≤–Ω—ñ—Å—Ç—å! ${winnersWithTrophy.join(', ')} –ø–æ–¥—ñ–ª–∏–ª–∏ –ø–µ—Ä—à–µ –º—ñ—Å—Ü–µ!`,
                `–ñ–æ–¥–Ω–æ–≥–æ —è–≤–Ω–æ–≥–æ –ª—ñ–¥–µ—Ä–∞ ‚Äî —É—Å—ñ –ø–µ—Ä–µ–º–æ–∂—Ü—ñ: ${winnersWithTrophy.join(', ')}!`
            ];

            const partialTieMsgs = [
                `–ü–µ—Ä–µ–º–æ–≥—É —Ä–æ–∑–¥—ñ–ª—è—é—Ç—å: ${winnersWithTrophy.join(', ')}!`,
                `–õ—ñ–¥–µ—Ä–∏ —Ü—å–æ–≥–æ —Ä–∞—É–Ω–¥—É: ${winnersWithTrophy.join(', ')}!`,
                `–î–µ–∫—ñ–ª—å–∫–∞ –≥—Ä–∞–≤—Ü—ñ–≤ –≤–∏–π—à–ª–∏ –Ω–∞ –≤–µ—Ä—à–∏–Ω—É: ${winnersWithTrophy.join(', ')}!`
            ];

            const noWinnerMsgs = [
                `–ü–µ—Ä–µ–º–æ–∂—Ü—è –Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–æ!`,
                `–ù—ñ—Ö—Ç–æ –Ω–µ –∑–¥–æ–±—É–≤ –ø–µ—Ä–µ–º–æ–≥–∏ —Ü—å–æ–≥–æ —Ä–∞–∑—É.`,
                `–¶—å–æ–≥–æ —Ä–∞–∑—É –≥—Ä–∞ –∑–∞–∫—ñ–Ω—á–∏–ª–∞—Å—å –±–µ–∑ –ª—ñ–¥–µ—Ä–∞.`
            ];

            // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–±–æ—Ä—É –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            function randomMsg(arr) {
                return arr[Math.floor(Math.random() * arr.length)];
            }

            // –õ–æ–≥—ñ–∫–∞ –≤–∏–±–æ—Ä—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            if (!winners || winners.length === 0) {
                resultHTML += `<h3>${randomMsg(noWinnerMsgs)}</h3>`;
            } else if (winners.length === 1) {
                resultHTML += `<h3>${randomMsg(singleWinnerMsgs)}</h3>`;
            } else if (winners.length === totalPlayers && totalPlayers === 3) {
                resultHTML += `<h3>${randomMsg(fullTieMsgs)}</h3>`;
            } else {
                resultHTML += `<h3>${randomMsg(partialTieMsgs)}</h3>`;
            }

                gameResultDiv.innerHTML = resultHTML;
                modal.style.display = "block";
        }

        function addLogEntry(message, type) {
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}-log`;
            logEntry.textContent = message;
            elements.gameHistory.appendChild(logEntry);
            elements.gameHistory.scrollTop = elements.gameHistory.scrollHeight;
        }

        window.onload = function() {
            if (window.location.protocol !== 'http:' && window.location.protocol !== 'https:') {
                console.warn("WebSocket client must be served over HTTP or HTTPS.");
            }
        };
    </script>
</body>
</html>

